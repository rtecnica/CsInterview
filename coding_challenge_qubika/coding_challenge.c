#include "inc/generator.h"
#include "inc/parser.h"
#include <stdio.h>

#define CHAROP_LIST_SIZE 20
#define STREAM_LENGTH (4096 * 4)
// GLOBALS
char s1[] = {0x02, 0x11, 0x31, 0x32, 0x2E, 0x31, 0x03, 0x02, 0x13, 0x32, 0x03, 0x02, 0x12, 0x33, 0x03,
             0x02, 0x0A, 0x03, 0x02, 0x18, 0x03, 0x02, 0x11, 0x32, 0x30, 0x30, 0x03, 0x02, 0x0A, 0x03};
char s2[] = {0x02, 0x11, 0x31, 0x32, 0x2E, 0x31, 0x03, 0x02, 0x13, 0x32, 0x03, 0x02, 0x02, 0x12, 0x33, 0x03,
             0x03, 0x02, 0x0A, 0x03, 0x02, 0x18, 0x03, 0x02, 0x11, 0x32, 0x30, 0x30, 0x03, 0x02, 0x0A, 0x03};

char s3[] = {0x02, 0x0a, 0x35, 0x02, 0x03, 0x37, 0x32, 0x39, 0x32, 0x1a, 0x39, 0x03, 0x02, 0x0a, 0x39, 0x36, 0x2e,
             0x30, 0x34, 0x30, 0x35, 0x34, 0x33, 0x03, 0x02, 0x14, 0x35, 0x35, 0x2e, 0x39, 0x32, 0x33, 0x30, 0x34,
             0x32, 0x03, 0x02, 0x13, 0x37, 0x37, 0x2e, 0x37, 0x61, 0x38, 0x38, 0x34, 0x39, 0x03, 0x02, 0x14, 0x39,
             0x32, 0x2e, 0x36, 0x36, 0x32, 0x33, 0x32, 0x33, 0x03, 0x02, 0x02, 0x35, 0x38, 0x2e, 0x34, 0x37, 0x30,
             0x36, 0x38, 0x30, 0x03, 0x02, 0x0a, 0x38, 0x2e, 0x31, 0x38, 0x32, 0x32, 0x33, 0x36, 0x03, 0x02, 0x18,
             0x39, 0x39, 0x2e, 0x37, 0x34, 0x38, 0x37, 0x33, 0x34, 0x03, 0x02, 0x18, 0x39, 0x39, 0x2e, 0x36, 0x38,
             0x36, 0x39, 0x38, 0x31, 0x03, 0x02, 0x13, 0x38, 0x38, 0x2e, 0x34, 0x5a, 0x33, 0x34, 0x36, 0x35, 0x03,
             0x02, 0x14, 0x38, 0x32, 0x2e, 0x38, 0x39, 0x34, 0x34, 0x51, 0x35, 0x03, 0x02, 0x12, 0x36, 0x30, 0x2e,
             0x33, 0x36, 0x38, 0x30, 0x31, 0x35, 0x03, 0x02, 0x0a, 0x36, 0x36, 0x2e, 0x38, 0x33, 0x33, 0x33, 0x37,
             0x34, 0x03, 0x02, 0x12, 0x36, 0x37, 0x2e, 0x38, 0x35, 0x33, 0x37, 0x37, 0x35, 0x03, 0x02, 0x11, 0x38,
             0x35, 0x2e, 0x36, 0x34, 0x39, 0x37, 0x35, 0x30, 0x03, 0x02, 0x14, 0x38, 0x36, 0x2e, 0x38, 0x38, 0x33,
             0x38, 0x35, 0x30, 0x03, 0x02, 0x18, 0x36, 0x35, 0x2e, 0x34, 0x33, 0x36, 0x36, 0x32, 0x33, 0x03, 0x02,
             0x12, 0x37, 0x34, 0x2e, 0x37, 0x31, 0x39, 0x37, 0x31, 0x39, 0x03, 0x02, 0x13, 0x37, 0x32, 0x2e, 0x31,
             0x32, 0x31, 0x30, 0x39, 0x34, 0x03, 0x02, 0x0a, 0x30, 0x2e, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x03};

charop_t oplist[CHAROP_LIST_SIZE];
char stream[STREAM_LENGTH];

int main(void) {
  // generate_charops(oplist, CHAROP_LIST_SIZE);
  // for (int i = 0; i < CHAROP_LIST_SIZE; i++) {
  //   print_charop(oplist[i]);
  // }
  // printf("Oplist generated with size %d\nResults: \n", CHAROP_LIST_SIZE);
  // accumulate_charops(oplist, CHAROP_LIST_SIZE);
  //
  // printf("Serializing oplist...\n");
  // convert_to_stream(oplist, CHAROP_LIST_SIZE, stream);
  // char* potato = stream;
  // printf("%c", '{');
  // while (*potato != 0) {
  //   printf("0x%02x", *potato);
  //   if (*(potato + 1) != 0) {
  //     printf("%s", ", ");
  //   } else {
  //     printf("%s", "");
  //   }
  //   potato++;
  // }
  // printf("%s", "};\n");

  size_t stream_len = sizeof(stream);
  process_packets(stream, stream_len);
  size_t s3_len = sizeof(s3);
  process_packets(s3, s3_len);
  return 0;
}
